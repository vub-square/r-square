<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Wilfried Cools">
<meta name="dcterms.date" content="2023-10-11">
<meta name="description" content="ggplot2">

<title>Advanced R: tidyverse - Visualization with R’s tidyverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Advanced R: tidyverse</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Tidyverse</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./manipulation.html" rel="" target="">
 <span class="menu-text">Manipulation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./visualization.html" rel="" target="" aria-current="page">
 <span class="menu-text">Visualization</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-context" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Context</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-context">    
        <li>
    <a class="dropdown-item" href="./rPrimer.html" rel="" target="">
 <span class="dropdown-text">R primer</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rProgramming.html" rel="" target="">
 <span class="dropdown-text">Programming</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./representation.html" rel="" target="">
 <span class="dropdown-text">Representation</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://square.research.vub.be/"><img src=".\_xtra/_hdr_logo.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#rs-tidyverse-package-ggplot2" id="toc-rs-tidyverse-package-ggplot2" class="nav-link active" data-scroll-target="#rs-tidyverse-package-ggplot2">R’s tidyverse package: ggplot2</a></li>
  <li><a href="#a-quick-illustration-with-ggplot2" id="toc-a-quick-illustration-with-ggplot2" class="nav-link" data-scroll-target="#a-quick-illustration-with-ggplot2">A quick illustration with ggplot2</a>
  <ul>
  <li><a href="#toy-dataset" id="toc-toy-dataset" class="nav-link" data-scroll-target="#toy-dataset">toy dataset</a></li>
  <li><a href="#toy-illustration" id="toc-toy-illustration" class="nav-link" data-scroll-target="#toy-illustration">toy illustration</a></li>
  </ul></li>
  <li><a href="#gg--grammar-of-graphics" id="toc-gg--grammar-of-graphics" class="nav-link" data-scroll-target="#gg--grammar-of-graphics">-gg- : grammar of graphics</a></li>
  <li><a href="#visualization-essentials" id="toc-visualization-essentials" class="nav-link" data-scroll-target="#visualization-essentials">Visualization essentials</a>
  <ul>
  <li><a href="#step-by-step-example" id="toc-step-by-step-example" class="nav-link" data-scroll-target="#step-by-step-example">step by step example</a></li>
  <li><a href="#ggplot" id="toc-ggplot" class="nav-link" data-scroll-target="#ggplot">ggplot( )</a></li>
  <li><a href="#aes" id="toc-aes" class="nav-link" data-scroll-target="#aes">aes( )</a></li>
  <li><a href="#geom_" id="toc-geom_" class="nav-link" data-scroll-target="#geom_">geom_*( )</a></li>
  </ul></li>
  <li><a href="#visualization-extras" id="toc-visualization-extras" class="nav-link" data-scroll-target="#visualization-extras">Visualization extras</a>
  <ul>
  <li><a href="#geom-and-stat-layers" id="toc-geom-and-stat-layers" class="nav-link" data-scroll-target="#geom-and-stat-layers">geom and stat layers</a></li>
  <li><a href="#scales__" id="toc-scales__" class="nav-link" data-scroll-target="#scales__">scales_*_*( )</a></li>
  <li><a href="#facet_" id="toc-facet_" class="nav-link" data-scroll-target="#facet_">facet_*( )</a></li>
  <li><a href="#theme" id="toc-theme" class="nav-link" data-scroll-target="#theme">theme( )</a></li>
  <li><a href="#coord_" id="toc-coord_" class="nav-link" data-scroll-target="#coord_">coord_*( )</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">summary</a></li>
  </ul></li>
  <li><a href="#examples-to-go-into-detail" id="toc-examples-to-go-into-detail" class="nav-link" data-scroll-target="#examples-to-go-into-detail">Examples to go into detail</a>
  <ul>
  <li><a href="#primitives" id="toc-primitives" class="nav-link" data-scroll-target="#primitives">primitives</a>
  <ul class="collapse">
  <li><a href="#exercises-on-primitives" id="toc-exercises-on-primitives" class="nav-link" data-scroll-target="#exercises-on-primitives">exercises on primitives</a></li>
  </ul></li>
  <li><a href="#one-variable" id="toc-one-variable" class="nav-link" data-scroll-target="#one-variable">one-variable</a>
  <ul class="collapse">
  <li><a href="#exercises-on-one-variable-visualizations" id="toc-exercises-on-one-variable-visualizations" class="nav-link" data-scroll-target="#exercises-on-one-variable-visualizations">exercises on one variable visualizations</a></li>
  </ul></li>
  <li><a href="#two-variables" id="toc-two-variables" class="nav-link" data-scroll-target="#two-variables">two-variables</a>
  <ul class="collapse">
  <li><a href="#exercises-on-two-variable-visualizations" id="toc-exercises-on-two-variable-visualizations" class="nav-link" data-scroll-target="#exercises-on-two-variable-visualizations">exercises on two variable visualizations</a></li>
  </ul></li>
  <li><a href="#intervals" id="toc-intervals" class="nav-link" data-scroll-target="#intervals">intervals</a></li>
  <li><a href="#third-variable-implied" id="toc-third-variable-implied" class="nav-link" data-scroll-target="#third-variable-implied">third variable implied</a></li>
  <li><a href="#three-variables" id="toc-three-variables" class="nav-link" data-scroll-target="#three-variables">three variables</a></li>
  </ul></li>
  <li><a href="#last-remarks" id="toc-last-remarks" class="nav-link" data-scroll-target="#last-remarks">Last remarks</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Visualization with R’s tidyverse</h1>
</div>

<div>
  <div class="description">
    ggplot2
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Wilfried Cools </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">In focus</div>
    Showing the data and its summaries.
  </div>
</div>

</header>

<!--
knitr::purl('visualization.qmd')
-->
<div class="callout callout-style-default callout-important callout-titled" title="What-Why-Who">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What-Why-Who
</div>
</div>
<div class="callout-body-container callout-body">
<p>Current draft aims to introduce researchers to visualization in R with the <code>ggplot2</code> package of the <code>tidyverse</code> ecosystem.</p>
<p>Our target audience is primarily the research community at VUB / UZ Brussel, those who have some basic experience in R and want to know more.</p>
<p>We invite you to help improve this document by sending us feedback: wilfried.cools@vub.be</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Key Message">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Message
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Data visualization can focus on data and/or its summarizing statistics
<ul>
<li>to convince yourself, understand data and statistical results</li>
<li>to convince others, show results to support inference</li>
</ul></li>
<li>Data visualization is inherent to data analysis
<ul>
<li>more than simply communicating the results</li>
<li>no -fit’s all data visualization-</li>
<li>flexible use of data visualization
<ul>
<li>supports more informative and complete visualizations</li>
<li>elicits better data exploration and modeling</li>
</ul></li>
</ul></li>
<li>Data visualization is best done with coding
<ul>
<li>maintain structure and transparency, to support reproducibility</li>
</ul></li>
<li>Data visualization is easier and more intuitive with tidy data
<ul>
<li>tidy data: meaning appropriately mapped into structure
<ul>
<li>each row an observation as research unit,</li>
<li>each column a variable as property,</li>
<li>each cell a particular value, linking row to column</li>
<li>note: data can be split into multiple tables (relational data).</li>
</ul></li>
<li>aim for tidy data registration (avoid tedious manipulations)</li>
</ul></li>
<li>Workflow (Hadley Wickham):</li>
</ul>
<p><img src="_img/tidyverseloop.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<section id="rs-tidyverse-package-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="rs-tidyverse-package-ggplot2">R’s tidyverse package: ggplot2</h2>
<!-- 4:00 -->
<p>Focus on <code>ggplot2</code> the visualization package in the <code>tidyverse</code> eco-system (Hadley Wickham etal.)</p>
<p>Different visualization packages exist in R.</p>
<ul>
<li>base R</li>
<li>grid</li>
<li>trellis/lattice graphics</li>
<li><code>ggplot2</code> (tidyverse) &amp; <code>ggviz</code></li>
</ul>
<p><code>ggplot2</code> the current default</p>
<ul>
<li>build on idea of Grammar of Graphics (Leland Wilkinson)
<ul>
<li>largely consistent</li>
<li>but still highly flexible</li>
</ul></li>
<li>tends to outperform base R for more complex visualizations</li>
<li>explicitly links to tidy data</li>
<li>but requires extensions for 3D plotting and interactive graphics</li>
<li>but does not allow for multiple Y-axes (combination of axes)</li>
</ul>
<p><code>ggplot2</code> part of the <code>tidyverse</code> ecosystem (Hadley Wickham etal.), includes:</p>
<ul>
<li><code>dplyr</code> for manipulating data frames [main focus]</li>
<li><code>tidyr</code> for tidying data [check Data Representation]</li>
<li><code>stringr</code> for dealing with texts</li>
<li><code>forcats</code> for dealing with factors</li>
<li>…</li>
</ul>
<!-- remove some of the above -->
<p>Convenient cheat sheets at https://rstudio.com/resources/cheatsheets/.</p>
<p><code>tidyverse</code> extends base R</p>
<ul>
<li>it is much more consistent (functions and packages) → ecosystem</li>
<li>it avoids poor historical choices, sets good defaults</li>
<li>it explicitly links to tidy data</li>
</ul>
</section>
<section id="a-quick-illustration-with-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="a-quick-illustration-with-ggplot2">A quick illustration with ggplot2</h2>
<section id="toy-dataset" class="level4">
<h4 class="anchored" data-anchor-id="toy-dataset">toy dataset</h4>
<p>The infamous <code>iris</code> data are used</p>
<ul>
<li>load examplary data available in R packages: <code>data( )</code> function</li>
<li>observe it’s structure with <code>str( )</code> and first 6 observations <code>head( )</code> function.</li>
</ul>
<p>Note: call <code>data( )</code> without arguments to see all available datasets</p>
<div class="columns small">
<div class="column" style="width:45%;">
<ul>
<li>a <code>tidyverse</code> look at the data with <code>glimpse( )</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.…
$ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
$ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.…
$ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
$ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s…</code></pre>
</div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<ul>
<li>a <code>tidyverse</code> look at the data with <code>slice_head( )</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="toy-illustration" class="level4">
<h4 class="anchored" data-anchor-id="toy-illustration">toy illustration</h4>
<p>Let’s make a scatterplot, boxplot, and histogram</p>
<div class="columns small">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>iris,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>Petal.Width,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span>Petal.Length,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span>Species)) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the iris data<br>
link dimensions y anx x to <code>Petal</code> columns<br>
link color to column <code>Species</code></p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_scatter_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>iris,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>Sepal.Length,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span>Species,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span>Species)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The x-axis is now <code>Species</code><br>
Boxplots show a distribution of values for each <code>Species</code></p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_box_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>iris,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Width)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The x-axis is now the Width<br>
A histogram shows the full distribution</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_hist_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><code>ggsave( )</code> saves the last made plot</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'plotname.png'</span>,<span class="at">width=</span><span class="dv">12</span>,<span class="at">height=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="gg--grammar-of-graphics" class="level2">
<h2 class="anchored" data-anchor-id="gg--grammar-of-graphics">-gg- : grammar of graphics</h2>
<!-- 5:00 -->
<p><code>ggplot</code> philosophy: Grammar of Graphics (Leland Wilkinson)</p>
<ul>
<li>build visualization like making a sentence
<ul>
<li>independently specify building blocks</li>
<li>combine blocks to create any graphical display</li>
</ul></li>
<li>example of layered building blocks with <code>ggplot( )</code>:
<ul>
<li><code>ggplot(data=iris,</code><br>
<code>aes(y=Petal.Width,x=Petal.Length,col=Species)) +</code><br>
<code>geom_point()</code></li>
<li><code>ggplot( )</code> creates a <code>ggplot</code> object
<ul>
<li>data argument to assign the dataframe (or tibble)</li>
<li><code>aes( )</code> function to assign variables from the dataframe to scales (x-axis, y-axis, color)</li>
</ul></li>
<li><code>geom_point( )</code> to visualize the ggplot object as a scatterplot
<ul>
<li>note: scatterplots require an x and y-axis, linked to variables in a dataframe</li>
</ul></li>
</ul></li>
</ul>
<p>General structure includes data, functions and arguments.</p>
<ul>
<li>functions
<ul>
<li><code>ggplot( )</code> function to initialize the ggplot object</li>
<li><code>geom_*( )</code> function to visualize data through their aesthetics</li>
<li><code>stat_*( )</code> function largely similar to <code>geom</code> but with focus on statistics</li>
<li><code>facet_*( )</code> function for grouping / conditional visualization</li>
<li><code>theme( )</code>, <code>guides( )</code>, <code>scale_*( )</code>, <code>coord_*( )</code></li>
</ul></li>
<li>arguments in <code>ggplot( )</code>, <code>geom_*( )</code> and <code>stat_*( )</code>
<ul>
<li><code>data</code> argument to specify data (=input)</li>
<li><code>aes( )</code> function as argument to specify aesthetic mapping (bridging gap input and output)</li>
<li><code>...</code></li>
</ul></li>
</ul>
<p>Grammar of Graphics sparked further developments</p>
<ul>
<li>other packages following the lead of GG offer additional functionality: <code>ggforce</code>, <code>ggalt</code>, <code>ggpubr</code>, <code>ggraph</code>, <code>tidygraph</code>, <code>GGally</code>, <code>ggcorrplot</code>, <code>ggridges</code>, <code>...</code>.</li>
</ul>
</section>
<section id="visualization-essentials" class="level2">
<h2 class="anchored" data-anchor-id="visualization-essentials">Visualization essentials</h2>
<p>First part addresses how to make a visualization,<br>
afterwards it is considered in less detail how to further make refinements.</p>
<section id="step-by-step-example" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-example">step by step example</h3>
<!-- 15:00 -->
<p>Use is made of the build-in <code>mtcars</code> and <code>iris</code> datasets</p>
<div class="columns small">
<div class="column" style="width:50%;">
<p>The ggplot object is constructed.</p>
<ul>
<li>data is assigned <code>mtcars</code> dataframe</li>
<li>x and y aesthetic is linked to the variables <code>mpg</code> and <code>disp</code> from the <code>mtcars</code> data</li>
</ul>
<p>No visualization is made yet, only the object is created.</p>
<ul>
<li>an internal representation does exist
<ul>
<li>ready to extend for visualization</li>
<li>aesthetics x and y are given their default values using the <code>mtcars</code></li>
<li>includes a legend and scale for both x and y axis</li>
</ul></li>
<li>any geometric object (function) that at least uses an x and y axis can be added as a layer</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>mtcars, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_scatter_prep_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>A layer is added with the <code>+</code> sign, adding a geometric function<br>
The geometric function visualizes the gglot object</p>
<p><code>geom_point( )</code>: geometric function without arguments to visualize a scatterplot</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p><code>geom_point()</code> requires data, an x and a y-axis</p>
<ul>
<li>if not specified, inherit from <code>ggplot( )</code></li>
<li>if specified, overwrite <code>ggplot( )</code></li>
</ul>
<p>example</p>
<ul>
<li>x is not specified inside, but inherited from <code>ggplot( )</code></li>
<li>y is specified inside, within <code>aes( )</code> because linked to data (mpg)</li>
<li>data is not specified inside, but inherited from <code>ggplot( )</code></li>
</ul>
<p><code>?geom_point</code> for the help file</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>disp)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>mpg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_overwrite_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Non-essential aesthetics can be included, for example color</p>
<p>Specified within the <code>aes( )</code>, values for color are extracted from the variable <code>gear</code> in <code>mtcars</code></p>
<ul>
<li>the numerical (continuous) variable gear is assigned a continuous scale of colors</li>
<li>a legend for continuous variables is by default included</li>
<li>note: color should be considered a third dimension</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span>gear)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_color_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Different types of data are visualized differently</p>
<p>Specified within the <code>aes( )</code>, values for color are extracted from the categorical variable <code>gear</code> in <code>mtcars</code></p>
<ul>
<li>the factor (categorical) variable gear is assigned a nominal scale of colors</li>
<li>a legend for categories is by default included for this third dimension</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="fu">factor</span>(gear))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_factor_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Default behavior can be written over</p>
<p>Specified within the <code>aes( )</code> of the geometric function, the default is overwritten</p>
<ul>
<li>the plot remains the same</li>
<li>the categorical version in <code>geom_point( )</code> overwrites the numerical in <code>ggplot( )</code></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,<span class="at">color=</span>gear)) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(gear))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p><code>aes()</code> is to link a dimension of the visualization to data, alternatively the visualization can be hard-coded</p>
<p>Specified outside the <code>aes( )</code> no relation with data exists</p>
<ul>
<li>color is now assigned a value independent of the actual data</li>
<li>color from the <code>ggplot( )</code> is overwritten</li>
<li>remember: <code>aes( )</code> is essential for linking aesthetics with data</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,<span class="at">color=</span>gear)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">'#FF6600'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_direct_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Multiple aesthetics can be specified, in and outside the <code>aes( )</code></p>
<p>With color dependent on gear</p>
<ul>
<li><p>alpha (transparency) outside of <code>aes( )</code> at .3 (30%)</p></li>
<li><p>alpha inside of <code>aes( )</code> assumes a link to a variable, not a percentage as such</p>
<ul>
<li>alpha as a percentage (avoid this, it gives unwanted behavior)</li>
<li>alpha related to variables with values between 0 and 1</li>
</ul></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(gear))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">alpha=</span>.<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_multiple1_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>With alpha (transparency) outside of <code>aes( )</code> at .3 (30%)</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(gear),<span class="at">alpha=</span>.<span class="dv">3</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_multiple2_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>With alpha inside of <code>aes( )</code> assumes a link to a variable, not a percentage as such</p>
<pre><code>- alpha as a percentage (avoid this, it gives unwanted behavior)
- alpha related to variables with values between 0 and 1</code></pre>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(gear),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha=</span>qsec<span class="sc">/</span><span class="fu">max</span>(qsec)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_multiple3_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Multiple geometric functions can be included</p>
<p><code>geom_point( )</code> creates the dots,<br>
<code>geom_line( )</code> connects them over the x-axis</p>
<p>note: it is possible to assign the <code>ggplot</code> objects and layer them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> myplot <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>myplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_line_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_linepoint_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p><code>geom_path( )</code> simply connects observations<br>
note: re-ordering has an effect (<code>arrange( )</code>)</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_path</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_path_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(drat), </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_path</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_path_order_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p><code>aes( )</code> in <code>ggplot( )</code> controls part of the result of geometric functions</p>
<p>For example, assigning a categorical variable to color is sufficient to group the lines (path)</p>
<p>The color is jointly defined as the grouping</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="fu">factor</span>(gear))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_path</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_color1_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>A different color, also groups observations differently</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_path</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_color2_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Specifications can be made in <code>ggplot( )</code> for default behavior, or inside the <code>geom_*( )</code> for local behavior</p>
<ul>
<li>note that the <code>geom_point( )</code> uses the locally specified color aesthetic</li>
<li>note that the <code>geom_line( )</code> uses the default black (size made smaller than default)</li>
</ul>
<p>Beware: types (discrete/continuous) should agree when overwriting <code>ggplot(aes( ))</code></p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(gear))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="at">linewidth=</span>.<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_color_linewidth_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Geometric functions that add statistics can be included as well</p>
<p><code>geom_smooth( )</code> offers averaging and standard errors</p>
<ul>
<li>local averages are default (loess lines)</li>
<li>global conditional averages can be requested</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,<span class="at">color=</span><span class="fu">factor</span>(gear)))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_multiple_stat_smooth_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_multiple_stat_lm_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Grouping through aesthetics works like before</p>
<ul>
<li>assigning a 1 to color causes all observations to belong to one group</li>
<li>the default blue is overwritten to orange</li>
</ul>
<p><code>?geom_smooth</code> for more details</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="fu">factor</span>(gear),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">group=</span><span class="dv">1</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="at">color=</span><span class="st">"#FF6600"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/data_example_geom_multiple_stat_lm_1_show_run-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="ggplot" class="level3">
<h3 class="anchored" data-anchor-id="ggplot">ggplot( )</h3>
<!-- 1:00 -->
<p>Function to create a <code>ggplot</code> object, ready for visualization.</p>
<ul>
<li>constructor, always required</li>
<li>prepares appropriate internal representation</li>
<li>can include default data</li>
<li>can include default aesthetics</li>
</ul>
</section>
<section id="aes" class="level3">
<h3 class="anchored" data-anchor-id="aes">aes( )</h3>
<!-- 2:30 -->
<p>Function to link variables (data) to an aesthetic (dimension)</p>
<ul>
<li>used within <code>ggplot( )</code> or <code>geom_*( )</code></li>
<li>requires variables (part of data)</li>
<li>defines dimensions dependent on variable values
<ul>
<li>x and y axes: positions on the axes</li>
<li>color: color</li>
<li>…</li>
</ul></li>
<li>possible arguments depent on <code>geom_*( )</code> if defined
<ul>
<li>shape: symbols in <code>geom_point( )</code></li>
<li>size: size of bullets in <code>geom_point( )</code></li>
<li>linewidth: width of lines in <code>geom_line( )</code></li>
<li>… check the respective help-files</li>
</ul></li>
<li>group argument used inside <code>aes( )</code> to identify groups of observations
<ul>
<li>allows grouping without assigning an aesthetic</li>
<li>use the value <code>1</code> to combine all observations into one group</li>
</ul></li>
<li>automatically assigns a default legend
<ul>
<li>relates to aesthetic</li>
<li>depends on variable type (nominal, ordinal, continuous)</li>
</ul></li>
<li>note: aesthetics defined outside of <code>aes( )</code> are independent of the data</li>
</ul>
</section>
<section id="geom_" class="level3">
<h3 class="anchored" data-anchor-id="geom_">geom_*( )</h3>
<!-- 1:30 -->
<p>Function to turn an internal <code>ggplot</code> representation into a visualization</p>
<ul>
<li>different geoms to create different visualizations</li>
<li>different geoms use
<ul>
<li>required aesthetics
<ul>
<li>scatterplots require x and y axis</li>
<li>histogram requires x axis</li>
</ul></li>
<li>optional aesthetics (eg., color)</li>
</ul></li>
<li>geom-specific arguments overwrite those inherited from <code>ggplot( )</code>
<ul>
<li>can include <code>aes( )</code></li>
<li>can include data argument</li>
<li>useful to add or change aesthetics</li>
</ul></li>
</ul>
</section>
</section>
<section id="visualization-extras" class="level2">
<h2 class="anchored" data-anchor-id="visualization-extras">Visualization extras</h2>
<p>While a ggplot object, layered with <code>geom_*( )</code> functions allows you to visualize data and statistics, there is much more.</p>
<section id="geom-and-stat-layers" class="level3">
<h3 class="anchored" data-anchor-id="geom-and-stat-layers">geom and stat layers</h3>
<!-- 8:00 -->
<p>Based on a <code>ggplot</code>-object, geometric functions and statistical transformation functions add layers.</p>
<div class="columns small">
<div class="column" style="width:50%;">
<p>A <code>geom_*( )</code> has a default stat argument, a <code>stat_*( )</code> has a default geom argument.</p>
<ul>
<li>same result:
<ul>
<li><code>stat_smooth(geom="smooth")</code></li>
<li><code>geom_smooth(stat="smooth")</code></li>
</ul></li>
<li>same result:
<ul>
<li><code>+ geom_point(stat='summary',fun.y='mean',shape=13,size=16)</code></li>
<li><code>+ stat_summary(geom='point',fun.y='mean',shape=13,size=16)</code></li>
</ul></li>
</ul>
<p>In most cases stick to <code>geom_*( )</code>, occasionally not possible: eg., ecdf.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span><span class="fu">factor</span>(carb),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="fu">factor</span>(gear))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">'point'</span>,<span class="at">fun.y=</span><span class="st">'mean'</span>,<span class="at">shape=</span><span class="dv">13</span>,<span class="at">size=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.
ℹ Please use the `fun` argument instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_stat_summary_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(mpg)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">stat_ecdf</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(cyl)),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"step"</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_stat_ecdf_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>A layer is a function with arguments</p>
<ul>
<li>data (see before)</li>
<li>mapping (aesthetic), defined by the <code>aes( )</code> (see before)</li>
<li>geom (eg., point or smooth)</li>
<li>stat (eg., identity or smooth)</li>
<li>position (eg., identity)</li>
</ul>
<p>Adjustment positions with position argument</p>
<ul>
<li>identity, typically the default</li>
<li>jitter convenient for points and lines (random perturbation)</li>
<li>stack, fill and dodge convenient for bars (on top or next to)</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>disp,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="fu">factor</span>(gear))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">200</span>, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width=</span><span class="dv">50</span>),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>.<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_position_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">200</span>, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_stack</span>(),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>.<span class="dv">8</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">'black'</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_stack_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>drat,<span class="at">color=</span>carb)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_jitter_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Generated variables are predefined transformations</p>
<ul>
<li>exist for some <code>geom_*( )</code> and <code>stat_*( )</code></li>
<li>start and end with <code>..</code></li>
<li>example: a histogram uses a <code>..density..</code></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_histogram</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>..density..),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth=</span><span class="dv">200</span>, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_stack</span>(),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>.<span class="dv">8</span>,<span class="at">col=</span><span class="st">'black'</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_density_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</section>
<section id="scales__" class="level3">
<h3 class="anchored" data-anchor-id="scales__">scales_*_*( )</h3>
<!-- 5:00 -->
<div class="columns small">
<div class="column" style="width:50%;">
<p>Each dimension (aesthetic) has a scale, which serves as a legend that helps interpretation of the visualized values.</p>
<p>Scales are referred to with aesthetic and type</p>
<ul>
<li>structure: scale_<aesthetic>_<type></type></aesthetic></li>
<li>arguments allow to control titles, breaks, labels, limits, … see the help file</li>
<li>examples:
<ul>
<li>scale_x_continuous to assign continuous scale to x-axis aesthetic</li>
<li>scale_x_sqrt to square root transform the x-axis aesthetic</li>
<li>scale_color_brewer to assign brewer colors to the discrete color aesthetic</li>
<li>scale_color_distiller to assign brewer colors to the continuous color aesthetic</li>
<li>scale_fill_gradient to assign colors to the fill aesthetic</li>
<li>scale_fill_manual to manually assign colors to the fill aesthetic</li>
</ul></li>
<li>scales can be visualized by the axes (x and y), or by the legend (eg. color)</li>
<li>note: guide argument requires either a name or <code>guides()</code> function for additional control</li>
</ul>
<p>Scale types have impact on the visualization (continuous vs.&nbsp;categorical)</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">fill=</span><span class="fu">factor</span>(gear))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_histogram</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>..density..),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth=</span><span class="dv">200</span>, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_stack</span>(),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>.<span class="dv">8</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">'black'</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>) <span class="sc">+</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_brewer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_hist_density_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>cyl,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>drat)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_distiller</span>(<span class="at">palette=</span><span class="st">'Oranges'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/plot_example_geom_distiller_show_run-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</section>
<section id="facet_" class="level3">
<h3 class="anchored" data-anchor-id="facet_">facet_*( )</h3>
<!-- 3:00 -->
<div class="columns small">
<div class="column" style="width:50%;">
<p>Visualizations can be split for subgroups, facilitating conditional comparisons.</p>
<ul>
<li>facets can be useful to keep plots simple</li>
<li>by default, the axes are kept constant for comparison, changeable</li>
<li><code>facet_grid( )</code> uses a grid, <code>facet_wrap( )</code> keeps filling space</li>
</ul>
<p><code>facet_grid( )</code> requires a row and/or column specification</p>
<ul>
<li>separate rows and columns by <code>~</code>, use <code>.</code> if none</li>
<li>using <code>+</code> allows for multiple row and/or column specification</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>drat,<span class="at">color=</span>carb)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_grid</span>(vs<span class="sc">~</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>drat,<span class="at">color=</span>carb)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_grid</span>(.<span class="sc">~</span>vs<span class="sc">+</span>cyl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
</section>
<section id="theme" class="level3">
<h3 class="anchored" data-anchor-id="theme">theme( )</h3>
<!-- 7:00 -->
<div class="columns small">
<div class="column" style="width:50%;">
<p>Themes offer control that is not related to data.</p>
<ul>
<li><p>themes are layers to (re-)specify theme elements</p></li>
<li><p>elements are numerous (<code>?theme</code>):</p>
<ul>
<li>line, rect, text, title</li>
<li>axis: axis.title, axis.text.x.top, axis.ticks.x.bottom, …</li>
<li>legend: legend.spacing.y, legend.key.width, legend.justification, …</li>
<li>panel: panel.background, panel.grid.major, panel.ontop, …</li>
<li>plot: plot.background, plot.caption, plot.tag, plot.margin, …</li>
<li>strip: strip.background, strip.text, strip.switch.pad.wrap, …</li>
</ul></li>
<li><p>elements are controlled with a theme function, eg., <code>element_text( )</code></p>
<ul>
<li><code>element_text( )</code>, <code>element_line( )</code>, <code>element_rect( )</code>, <code>margin( )</code>, …</li>
</ul></li>
<li><p>default themes exist, eg., <code>theme_minimal( )</code>, new can be created</p></li>
<li><p><code>labs( )</code> is a simpler way to specify titles and labels</p></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(px <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(wt, mpg)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fuel economy declines as weight increases"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">'miles per gallon'</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
<div class="columns small">
<div class="column" style="width:50%;">
<p>The size of the plot title is changed with the <code>element_text( )</code>, the background with the <code>element_rect( )</code></p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)), </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"#FF6600"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>The inside of the plot is the panel, modifiable too.</p>
<ul>
<li>multiple elements can be specified in one theme</li>
<li>multiple themes can be specified by layers</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(py <span class="ot">&lt;-</span> px <span class="sc">+</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">'#FF6600'</span>,<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">panel.background =</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#003399"</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"#FF6600"</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="cn">NA</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"#FF6600"</span>)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>py <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>On the outside are the axes and titles, modifiable too.</p>
<ul>
<li>the text, ticks and titles are adjusted for color and size</li>
<li>function <code>element_text( )</code>, <code>element_line( )</code> and <code>unit( )</code> are used</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(py <span class="ot">&lt;-</span> px <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"#FF6600"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"#003399"</span>, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">size=</span><span class="dv">12</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.y =</span> </span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>))</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>py <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(.<span class="dv">25</span>, <span class="st">"cm"</span>),</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.ticks.length.x =</span> <span class="fu">unit</span>(<span class="sc">-</span>.<span class="dv">25</span>, <span class="st">"cm"</span>),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> .<span class="dv">3</span>, <span class="at">unit =</span> <span class="st">"cm"</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Scales are represented by legends, modifiable too</p>
<ul>
<li>labs can be used to change multiple legend titles</li>
<li>legends can be positioned and formatted</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(cyl), </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">shape =</span> <span class="fu">factor</span>(vs))</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Fuel economy (mpg)"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Cylinders"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">shape =</span> <span class="st">"Transmission"</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="st">"right"</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.box.just =</span> <span class="st">"right"</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Keys inside legends are modifiable too</p>
<ul>
<li>labs can be used to change multiple legend titles</li>
<li>legends can be positioned and formatted, for key, text and title</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"#bbbbbb"</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"#003399"</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">14</span>, </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"#003399"</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Themes also work on facets, at which strips are defined</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(wt, mpg)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> cyl)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"white"</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"white"</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.spacing =</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
</section>
<section id="coord_" class="level3">
<h3 class="anchored" data-anchor-id="coord_">coord_*( )</h3>
<!-- 4:00 -->
<div class="columns small">
<div class="column" style="width:50%;">
<p>Typically the default cartesian coordinate system is used, <code>coord_cartesian( )</code>.</p>
<p>Limits of the axes are best specified within the <code>coord_*( )</code> function</p>
<ul>
<li>works like a zoom</li>
<li>alternatively, use <code>xlim( )</code> and <code>ylim( )</code>
<ul>
<li>beware that values outside the boundary are treated as missing</li>
</ul></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>gear,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="fu">factor</span>(vs),</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">group=</span>vs)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>) <span class="sc">+</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">4.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>) <span class="sc">+</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fl">2.5</span>,<span class="fl">4.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Within the cartesian family alternatives exist</p>
<ul>
<li><code>coord_flip( )</code> switches x and y-axis</li>
<li><code>coord_fixed( )</code> sets the ratio for x and y values
<ul>
<li>eg., .1 means 1 unit on x is 10 on y</li>
</ul></li>
</ul>
<p>Alternatives exist, eg., <code>coord_polar( )</code>, <code>coord_trans( )</code>, and various map related functions</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>) <span class="sc">+</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>) <span class="sc">+</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>(.<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>) <span class="sc">+</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_polar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">summary</h3>
<ul>
<li><code>ggplot</code> creates a ggplot object, required for visualization</li>
<li><code>aes( )</code> combines aesthetics and link data to scales, and group them</li>
<li><code>geom_*( )</code> are geom functions that visualize a ggplot object</li>
<li><code>stat_*( )</code> are stat functions that also visualize a ggplot object</li>
<li><code>scale_*_*( )</code> helps fine-tuning visualized dimensions</li>
<li><code>facet_grid( )</code> or <code>facet_wrap( )</code> split dimensions over panels (faceting)</li>
<li><code>coords( )</code> re-specify the coordinate system, and helps zooming in</li>
<li><code>theme( )</code> re-specifies data independent characteristics</li>
</ul>
</section>
</section>
<section id="examples-to-go-into-detail" class="level2">
<h2 class="anchored" data-anchor-id="examples-to-go-into-detail">Examples to go into detail</h2>
<p>Through various examples the cheat sheet is focused upon. https://rstudio.com/resources/cheatsheets/</p>
<section id="primitives" class="level3">
<h3 class="anchored" data-anchor-id="primitives">primitives</h3>
<!-- 3:00 -->
<p>Primitives are the basic building blocks.</p>
<ul>
<li>several primitives exist: point( ), path( ), polygon( ), segment( ), ribbon( ), rect( ), text( ), blank( )</li>
<li>only <code>geom_point( )</code> is used very often</li>
<li><code>geom_ribbon( )</code> can be interesting for showing intervals</li>
<li>typically useful for fine-tuning only</li>
</ul>
<div class="columns small">
<div class="column" style="width:50%;">
<p>The <code>polygon( )</code> is used. The coordinates of the polygon are created in a separate datafile. The same is done with <code>tiles( )</code>. It is possible to create the datafile within the function.</p>
<p>First a blank plot is drawn, then the rest is added.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>blank_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>cyl)) <span class="sc">+</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_blank</span>()</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>polygon_coordinate_file <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="sc">~</span>x,<span class="sc">~</span>y,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>,<span class="dv">17</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>,<span class="dv">10</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>,<span class="dv">10</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>,<span class="dv">21</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>tile_coordinate_file <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="sc">~</span>x,<span class="sc">~</span>y,<span class="sc">~</span>w,</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">2</span>,</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>,<span class="dv">30</span>,<span class="dv">5</span>,</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>,<span class="dv">15</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(updated_plot <span class="ot">&lt;-</span> blank_plot <span class="sc">+</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data=</span>polygon_coordinate_file,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">alpha=</span>.<span class="dv">3</span>,<span class="at">color=</span><span class="st">"#FF6600"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>(updated_plot <span class="ot">&lt;-</span> updated_plot <span class="sc">+</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">data=</span>tile_coordinate_file,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">width=</span><span class="dv">2</span>),<span class="at">alpha=</span>.<span class="dv">3</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="st">"#003399"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>updated_plot <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">data=</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">5</span>,<span class="at">y=</span><span class="dv">15</span>,<span class="at">xend=</span><span class="dv">7</span>,<span class="at">yend=</span><span class="dv">20</span>),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">xend=</span>xend,<span class="at">yend=</span>yend),</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">5</span>,<span class="at">color=</span><span class="st">"#FF6600"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
<section id="exercises-on-primitives" class="level4">
<h4 class="anchored" data-anchor-id="exercises-on-primitives">exercises on primitives</h4>
<p>The <code>mpg</code> dataset is part of tidyverse’s ggplot !</p>
<div class="cell">
<details>
<summary>an R solution</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Have a glimpse at the data, what data-types are included ?</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre class="exercise-output"><code>Rows: 234
Columns: 11
$ manufacturer &lt;chr&gt; "audi", "audi", "audi", "audi", "audi", "audi", "audi", "…
$ model        &lt;chr&gt; "a4", "a4", "a4", "a4", "a4", "a4", "a4", "a4 quattro", "…
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0, 2.…
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, 200…
$ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, 8, …
$ trans        &lt;chr&gt; "auto(l5)", "manual(m5)", "manual(m6)", "auto(av)", "auto…
$ drv          &lt;chr&gt; "f", "f", "f", "f", "f", "f", "f", "4", "4", "4", "4", "4…
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17, 1…
$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25, 2…
$ fl           &lt;chr&gt; "p", "p", "p", "p", "p", "p", "p", "p", "p", "p", "p", "p…
$ class        &lt;chr&gt; "compact", "compact", "compact", "compact", "compact", "c…</code></pre>
</div>
</div>
<p>Make a scatterplot for <code>cty</code> per <code>hwy</code>, and assign it to the object name ‘current’</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>current <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span>cty)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Draw 2 rectangles with <code>geom_rect( )</code>,<br>
one with corners 10,15 and 20,25,<br>
one shifted with 5 both dimensions,<br>
using 2 additional dataframes (tibbles) to store the coordinates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp &lt;- data.frame(</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># c1=c(10,15),</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># c2=c(15,20),</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># c3=c(25,30),</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># c4=c(35,40))</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>my_2_sets_of_coordinates <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span>xi,<span class="sc">~</span>yi,<span class="sc">~</span>xa,<span class="sc">~</span>ya,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">25</span>,<span class="dv">35</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the coordinates on top of the scatterplot<br>
Note: the argument inherit.aes=FALSE avoids inheriting aesthetics</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>current <span class="sc">+</span> <span class="fu">geom_rect</span>(<span class="at">data=</span>my_2_sets_of_coordinates,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xmin=</span>xi,<span class="at">ymin=</span>yi,<span class="at">xmax=</span>xa,<span class="at">ymax=</span>ya),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes=</span><span class="cn">FALSE</span>,<span class="at">alpha=</span>.<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Add a different color to each separately, use ‘#FF6600’ and ‘#003399’</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>current <span class="sc">+</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data=</span>my_2_sets_of_coordinates[<span class="dv">1</span>,],</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">xmin=</span>xi,<span class="at">ymin=</span>yi,<span class="at">xmax=</span>xa,<span class="at">ymax=</span>ya),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">inherit.aes=</span><span class="cn">FALSE</span>,<span class="at">alpha=</span>.<span class="dv">3</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill=</span><span class="st">"#003399"</span>) <span class="sc">+</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data=</span>my_2_sets_of_coordinates[<span class="dv">2</span>,],</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">xmin=</span>xi,<span class="at">ymin=</span>yi,<span class="at">xmax=</span>xa,<span class="at">ymax=</span>ya),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">inherit.aes=</span><span class="cn">FALSE</span>,<span class="at">alpha=</span>.<span class="dv">3</span>,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill=</span><span class="st">"#FF6600"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="one-variable" class="level3">
<h3 class="anchored" data-anchor-id="one-variable">one-variable</h3>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Various visualizations address one particular variable, mostly continuous but possibly also discrete.<br>
A continuous variables is typically ‘binned’ into groups within which frequencies are obtained.</p>
<p>Note the frequency polygon, and the histogram.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(mpg)) <span class="sc">+</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_freqpoly</span>(<span class="at">binwidth=</span><span class="fl">2.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(mpg)) <span class="sc">+</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">2.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>When using the <code>geom_area( )</code> such binning must be explicitly included as stat argument.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(mpg)) <span class="sc">+</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="at">stat=</span><span class="st">'bin'</span>,<span class="at">binwidth=</span><span class="fl">2.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Continuous variables can also be shown continuously.</p>
<p>Different types of densities are shown.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(mpg)) <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">kernel=</span><span class="st">'triangular'</span>,<span class="at">color=</span><span class="st">"#003399"</span>) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">kernel=</span><span class="st">'optcosine'</span>,<span class="at">color=</span><span class="st">"#FF6600"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>The <code>geom_qq( )</code> requires a sample argument instead of x, as positions are determined by their size.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">sample=</span>mpg)) <span class="sc">+</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>The bar-plot with <code>geom_bar( )</code> is similar to the histogram but shows the actual values instead of a count per bin.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">'#FF6600'</span>,<span class="at">color=</span><span class="st">'#003399'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
<section id="exercises-on-one-variable-visualizations" class="level4">
<h4 class="anchored" data-anchor-id="exercises-on-one-variable-visualizations">exercises on one variable visualizations</h4>
<p>Make use of the <code>mpg</code> dataset again<br>
Make a histogram for the continuously scaled <code>displ</code> variable</p>
<div class="cell">
<details>
<summary>an R solution</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ)) <span class="sc">+</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Adjust the binwidth to .5 Have a glimpse at the data, what data-types are included ?</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ)) <span class="sc">+</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Add a frequency polynomial on top (freqpoly)</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ)) <span class="sc">+</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_freqpoly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice what happens if the same binwidth is used for the frequency polynomial.</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ)) <span class="sc">+</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_freqpoly</span>(<span class="at">binwidth=</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Make a barplot for the discretely scaled <code>class</code> variable</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>class)) <span class="sc">+</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Group the data by filling in colors dependent on the <code>drv</code> variable</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>class)) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>drv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Turn the bars next to one-another<br>
Reduce their width to .5 to increase space between bars</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">x=</span>class)) <span class="sc">+</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>drv),</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">position=</span><span class="st">'dodge'</span>,<span class="at">width=</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="two-variables" class="level3">
<h3 class="anchored" data-anchor-id="two-variables">two-variables</h3>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Various visualizations address the relation between two variables, whether discrete and/or continuous.</p>
<p>Especially for categorical data data could obscure other data. Deal with this using the position argument or with the <code>geom_jitter( )</code>. Avoid combining both <code>geom_point( )</code> and <code>geom_jitter( )</code> as it would draw points each time.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(cyl,gear)) <span class="sc">+</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(cyl,gear)) <span class="sc">+</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">width=</span>.<span class="dv">2</span>,<span class="at">height=</span>.<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(cyl,gear)) <span class="sc">+</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">'#FF6600'</span>) <span class="sc">+</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">width=</span>.<span class="dv">2</span>,<span class="at">height=</span>.<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>The smooth function has been shown above, changing the confidence band into areas that capture that middle 50% (quantiles .25 and .75), and including a rug at the axes to capture the one dimensional distribution.</p>
<p>Instead of bullet indicators, the row names or any other set of labels can be used using the label argument (within the <code>aes( )</code> when related to data). A bit of jitter is added to avoid overlap.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>disp,<span class="at">color=</span><span class="fu">factor</span>(gear))) <span class="sc">+</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rug</span>() <span class="sc">+</span> </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_quantile</span>(<span class="at">quantiles=</span><span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">75</span>),<span class="at">linetype=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
Smoothing formula not specified. Using: y ~ x
Smoothing formula not specified. Using: y ~ x
Smoothing formula not specified. Using: y ~ x</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label=</span>(<span class="fu">rownames</span>(mtcars))),</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">2</span>,<span class="at">height=</span><span class="dv">3</span>, <span class="at">seed=</span><span class="dv">256</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,<span class="fu">aes</span>(cyl,gear)) <span class="sc">+</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">'#FF6600'</span>) <span class="sc">+</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">width=</span>.<span class="dv">2</span>,<span class="at">height=</span>.<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Like with one dimensional discrete data, bars can be obtained with <code>geom_col( )</code>, or with <code>geom_bar(stat='identity')</code>. Use of ‘identity’ causes the height to depend on the numbers in the data. It sums these numbers if not unique, be careful.</p>
<p>A <code>count( )</code> extracts the frequency of the specified grouping, this is the one visualized.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(freq_by_group <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(gear,vs) <span class="sc">%&gt;%</span> <span class="fu">count</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   gear, vs [6]
   gear    vs     n
  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1     3     0    12
2     3     1     3
3     4     0     2
4     4     1    10
5     5     0     4
6     5     1     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(freq_by_group, </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(vs), <span class="at">y=</span>n, <span class="at">x=</span>gear)) <span class="sc">+</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">"stack"</span>, <span class="at">stat=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(freq_by_group, </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(vs), <span class="at">y=</span>n, <span class="at">x=</span>gear)) <span class="sc">+</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(vs), <span class="at">y=</span>mpg, <span class="at">x=</span>gear)) <span class="sc">+</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">y=</span><span class="st">'sums all mpg values'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>An interesting visualization for continuous data, possibly for different groups, is the boxplot.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width=</span>.<span class="dv">25</span>,<span class="at">alpha=</span>.<span class="dv">2</span>,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width=</span>.<span class="dv">05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
<section id="exercises-on-two-variable-visualizations" class="level4">
<h4 class="anchored" data-anchor-id="exercises-on-two-variable-visualizations">exercises on two variable visualizations</h4>
<p>Use the <code>mpg</code> dataset again.</p>
<p>Make a scatterplot histogram for the continuously scaled <code>hwy</code> on <code>cty</code>, and color by <code>cyl</code></p>
<div class="cell">
<details>
<summary>an R solution</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span>cty,<span class="at">color=</span>cyl)) <span class="sc">+</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Jitter the data, so it shows if data points obscure one-another<br>
Make sure that <code>cyl</code> is categorical</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span>cty,<span class="at">color=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Add a conditional average with <code>geom_smooth( )</code>, use the <code>lm</code> method</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span>cty,<span class="at">color=</span>class)) <span class="sc">+</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Add a shape dependent on <code>class</code>, notice the restriction on the number of shapes</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span>cty)) <span class="sc">+</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="fu">aes</span>(<span class="at">color=</span>class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Switch the color and shapes around (color can have more than 6 if it is really necessary)</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span>cty)) <span class="sc">+</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="fu">aes</span>(<span class="at">color=</span>class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Make sure the symbols do not differ by color (all black), only shape, but keep the regression lines</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span>cty)) <span class="sc">+</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="fu">aes</span>(<span class="at">color=</span>class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Show boxplots for the <code>hwy</code> for each <code>cyl</code></p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Add the actual data points and make sure they do not obscure each other</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Give a color to the observations dependent on <code>class</code></p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color=</span>class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Make a bar chart that add all <code>hwy</code> values in each <code>class</code> group</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span><span class="fu">factor</span>(class))</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Use a coloring of the bars to signal the relative contribution of all <code>cyl</code> categories</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span><span class="fu">factor</span>(class),</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Flip the coordinates x and y axis</p>
<div class="cell">
<details>
<summary>a tidyverse solution</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>hwy,<span class="at">x=</span><span class="fu">factor</span>(class),</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="fu">factor</span>(cyl))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="intervals" class="level3">
<h3 class="anchored" data-anchor-id="intervals">intervals</h3>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Specialized functions facilitate visualization of errors / confidence intervals.</p>
<p>When standard errors are obtained, along with fitted values, they are easily shown. Other intervals can be visualized this way too.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>(tmp <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="sc">~</span>set,<span class="sc">~</span>fit,<span class="sc">~</span>se,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">3</span>,.<span class="dv">2</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">2</span>,.<span class="dv">3</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>,<span class="dv">2</span>,.<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    set   fit    se
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1     3   0.2
2     2     2   0.3
3     3     2   0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>(px <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tmp,</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>fit,<span class="at">x=</span>set)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_errorbar</span>(</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymax=</span>fit<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>se,<span class="at">ymin=</span>fit<span class="dv">-2</span><span class="sc">*</span>se)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_errorbarh</span>(</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xmax=</span>fit<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>se,<span class="at">xmin=</span>fit<span class="dv">-2</span><span class="sc">*</span>se)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_crossbar</span>(</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymax=</span>fit<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>se,<span class="at">ymin=</span>fit<span class="dv">-2</span><span class="sc">*</span>se)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>px <span class="sc">+</span> <span class="fu">geom_pointrange</span>(</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymax=</span>fit<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>se,<span class="at">ymin=</span>fit<span class="dv">-2</span><span class="sc">*</span>se)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
</section>
<section id="third-variable-implied" class="level3">
<h3 class="anchored" data-anchor-id="third-variable-implied">third variable implied</h3>
<div class="columns small">
<div class="column" style="width:50%;">
<p>Frequencies and densities can be obtained for two variables.</p>
<p>With <code>geom_bin2d( )</code> the frequency of combinations is obtained, in this case for the factors cyl and gear. Because using bins also continuous variables can be used. The <code>geom_density2d( )</code> is also used with continuous variables, with contours depending on for example the gear levels.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(cyl),<span class="at">x=</span><span class="fu">factor</span>(gear))</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bin2d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars,</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>mpg,<span class="at">x=</span>carb)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">geom_density2d</span>(</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(gear))</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
</section>
<section id="three-variables" class="level3">
<h3 class="anchored" data-anchor-id="three-variables">three variables</h3>
<div class="columns small">
<div class="column" style="width:50%;">
<p>While typically a third variable is included using aesthetics, it can be done with the z dimension as well.</p>
<p>When a third dimension is linked to a combination of conditions, they are easily shown. For the example meaningless data are simulated, 100 observations of which the first 6 are shown.</p>
<p>A heatmap is the most obvious use, to show for example correlations between many variables with colors instead of values. A small example is used instead. Notice that the argument for tile is a fill while for contour is is simply z.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">set1=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">set2=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>); </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>); </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>tmp<span class="sc">$</span>score <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  set1 set2     score
1    1    1 0.2875775
2    2    1 0.7883051
3    3    1 0.4089769
4    4    1 0.8830174
5    5    1 0.9404673
6    6    1 0.0455565</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>tmp,</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>set2,<span class="at">x=</span>set1)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>tmp,</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>set2,<span class="at">x=</span>set1)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z=</span>score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visualization_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="last-remarks" class="level2">
<h2 class="anchored" data-anchor-id="last-remarks">Last remarks</h2>
<p>Current page provides a primer on visualization, which is a key tool for understanding data and statistics required within the process of data analyses.</p>
<p>Get ahead at https://ggplot2-book.org/</p>
<p>It is strongly advised to play with the techniques discussed above to get some proficiency in using it, as it would add significantly to the flexibility of whatever you want to further do with your data.</p>
<p><img src="_img/tidyverseloop.png" class="img-fluid" style="width:80.0%"></p>
<p>Other tidyverse package exist, and within the same framework many more are being developed. The consistency within the tidyverse ecosystem should give you a push though, to study the other packages yourself when of interest.</p>
<p>Base R still is a proper alternative to the tidyverse ecosystem, so be aware that others may do things differently.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>